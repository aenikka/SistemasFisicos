void setup()
{
  Serial.begin(115200);
}


void Bomb()
{

  enum class BombState {SETUP, ACTIVATED};
  static uint8_t counter = 20;
  static BombState bombstate =  BombState::SETUP;
  static uint32_t previousMillis = 0;
  const uint32_t interval = 1000;


  switch (bombstate)
  {

    case  BombState::SETUP:
      {
        
        //condicional para leer los eventos que quiera evaluar
        //UP,DOWN,ARM
        if (Serial.available() > 0) {
          int dataRx = Serial.read();

          if (dataRx == 'u')
          {
            if (counter < 60)
            {
              counter++;
              Serial.println(counter);
            }
          }
          else if (dataRx == 'd')
          {
            if (counter > 10)
            {
              counter--;
              Serial.println(counter);
            }
          }
          else if (dataRx == 'a')
          {
            bombstate = BombState::ACTIVATED;
            previousMillis = millis();

          }

        }

        break;
      }


    case BombState::ACTIVATED:
      {
        if (Serial.available() > 0)
        {
          int dataRx = Serial.read();



        }

        if (millis() - previousMillis >= interval)
        {
          counter --;
          previousMillis = millis();
          Serial.println(counter);


          if (counter == 0)
          {
            bombstate = BombState::SETUP;
            Serial.println("KABOOM!");
            counter = 20;

          }
        }


        break;
      }


    default:
      Serial.println("Error");
      break;
  }




}



void loop() {
  Bomb();

}
